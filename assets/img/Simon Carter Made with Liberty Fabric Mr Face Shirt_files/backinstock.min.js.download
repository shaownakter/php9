function ekmBackInStock(e,t,n,a){var c=new ekmBackInStockUtils,o=document.getElementById("ekm-backinstock-email").value;if(!window[t]||"function"!=typeof window[t]||!1!==window[t](o)){if(c.validateEmail(o)){var i=c.createRequestObject();i?(i.open("get","index.asp?ProductID="+e+"&email="+o+"&function=BACKINSTOCK&ajax=true&rand="+Math.floor(9999999*Math.random())),i.onreadystatechange=function(){if(4==i.readyState&&"OK"==i.responseText){if(window[n]&&"function"==typeof window[n]&&!1===window[n]())return;document.getElementById("ekm-backinstock-div").innerHTML=ekmbackinstockData.requestmadetext,window["backInStockVariant"+e]=ekmbackinstockData.requestmadetext}else if(window[a]&&"function"==typeof window[a]&&!1===window[a]())return},i.send(null)):window.location="index.asp?ProductID="+e+"&email="+o+"&function=BACKINSTOCK"}return!1}}function ekmBackInStockCheck(e,t){var n=new ekmBackInStockUtils;if("True"==t)document.getElementById("ekm-backinstock").innerHTML=ekmbackinstockData.inStocktext;else{var a=n.createRequestObject();a&&(a.open("get","index.asp?productid="+e+"&function=BackInStockCheck&rand="+Math.floor(9999999*Math.random())),a.onreadystatechange=function(){if(4==a.readyState)if(JSON.parse(a.responseText).requestAlreadyMade)document.getElementById("ekm-backinstock").innerHTML=ekmbackinstockData.requestmadetext;else{var t="";for(var c in ekmbackinstockData.emailcookies){var o=n.readCookie(ekmbackinstockData.emailcookies[c],"username");if(null!=o){t=o;break}}document.getElementById("ekm-backinstock").innerHTML=ekmbackinstockData.outStockthtml.replace("[ekm-backinstock-email-value]",t).replace("[ekmCmProductCode]",e)}},a.send(null))}}var ekmBackInStockUtils=function(){};ekmBackInStockUtils.prototype={createRequestObject:function(){var e;try{e=new XMLHttpRequest}catch(t){try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){e=!1}}}return e},validateEmail:function(e){return/^(([^<>()[\]\\.,';:\s@\"]+(\.[^<>()[\]\\.,';:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA	-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)},readCookie:function(e,t){for(var n=e.replace(new RegExp("_","g"),"%5F")+"=",a=document.cookie.split(";"),c=0;c<a.length;c++){for(var o=a[c];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(n))for(var i=decodeURIComponent(o.substring(n.length,o.length)).split("&"),r=t+"=",k=0;k<i.length;k++)if(0==i[k].indexOf(r))return i[k].substring(r.length,i[k].length)}return null}};