!function(e){e.fn.lightBox=function(i){var t=!1;i=e.extend({margin:200,top:0,overlayBgColor:"#000",overlayOpacity:.8,fixedNavigation:!1,imageLoading:"/ekmps/assets/images/features/lightbox/images/lightbox-ico-loading.gif",imageBtnPrev:"/ekmps/assets/images/features/lightbox/images/lightbox-btn-prev.gif",imageBtnNext:"/ekmps/assets/images/features/lightbox/images/lightbox-btn-next.gif",imageBtnClose:"/ekmps/assets/images/features/lightbox/images/lightbox-btn-close.gif",imageBlank:"/ekmps/assets/images/features/lightbox/images/lightbox-blank.gif",containerBorderSize:10,containerResizeSpeed:400,txtImage:"Image",txtOf:"of",keyToClose:"c",keyToPrev:"p",keyToNext:"n",imageArray:[],activeImage:0},i);var a=this;function n(){e("#lightbox-loading").show(),e("#lightbox-video-link").hide(),i.fixedNavigation?e("#lightbox-image,#lightbox-container-image-data-box,#lightbox-image-details-currentNumber").hide():e("#lightbox-image,#lightbox-nav,#lightbox-nav-btnPrev,#lightbox-nav-btnNext,#lightbox-container-image-data-box,#lightbox-image-details-currentNumber").hide();var t=new Image;t.onload=function(){e("#lightbox-image").attr("src",i.imageArray[i.activeImage][0]);var a=i.margin+20,g=c(),d=t.width/(g[2]-a),m=t.height/(g[3]-a),h=d<m?m:d,s=t.width,b=t.height;h>1&&(s/=h,b/=h),e("#lightbox-image").css({width:s,height:b}),function(t,a){var g=e("#lightbox-container-image-box").width(),c=e("#lightbox-container-image-box").height(),d=t+2*i.containerBorderSize,m=a+2*i.containerBorderSize,h=g-d,s=c-m;e("#lightbox-container-image-box").animate({width:d,height:m},i.containerResizeSpeed,function(){e("#lightbox-loading").hide(),e("#lightbox-image").fadeIn(function(){e("#lightbox-container-image-data-box").slideDown("fast"),e("#lightbox-image-details-caption").hide(),i.imageArray[i.activeImage][1]&&e("#lightbox-image-details-caption").html(i.imageArray[i.activeImage][1]).show(),i.imageArray.length>1&&e("#lightbox-image-details-currentNumber").html(i.txtImage+" "+(i.activeImage+1)+" "+i.txtOf+" "+i.imageArray.length).show(),e("#lightbox-nav").show(),e("#lightbox-nav-btnPrev,#lightbox-nav-btnNext").css({background:"transparent url("+i.imageBlank+") no-repeat"}),0!=i.activeImage&&(i.fixedNavigation?e("#lightbox-nav-btnPrev").css({background:"url("+i.imageBtnPrev+") left 15% no-repeat"}).unbind().bind("click",function(){return i.activeImage=i.activeImage-1,n(),!1}):e("#lightbox-nav-btnPrev").unbind().hover(function(){e(this).css({background:"url("+i.imageBtnPrev+") left 15% no-repeat"})},function(){e(this).css({background:"transparent url("+i.imageBlank+") no-repeat"})}).show().bind("click",function(){return i.activeImage=i.activeImage-1,n(),!1})),i.activeImage!=i.imageArray.length-1&&(i.fixedNavigation?e("#lightbox-nav-btnNext").css({background:"url("+i.imageBtnNext+") right 15% no-repeat"}).unbind().bind("click",function(){return i.activeImage=i.activeImage+1,n(),!1}):e("#lightbox-nav-btnNext").unbind().hover(function(){e(this).css({background:"url("+i.imageBtnNext+") right 15% no-repeat"})},function(){e(this).css({background:"transparent url("+i.imageBlank+") no-repeat"})}).show().bind("click",function(){return i.activeImage=i.activeImage+1,n(),!1})),i.imageArray[i.activeImage][2]?e("#lightbox-video-link").show():e("#lightbox-video-link").hide(),e(document).unbind(),e(document).keydown(function(e){!function(e){null==e?(keycode=event.keyCode,escapeKey=27):(keycode=e.keyCode,escapeKey=e.DOM_VK_ESCAPE),key=String.fromCharCode(keycode).toLowerCase(),(key==i.keyToClose||"x"==key||keycode==escapeKey)&&r(),key!=i.keyToPrev&&37!=keycode||0!=i.activeImage&&(i.activeImage=i.activeImage-1,n(),o()),key!=i.keyToNext&&39!=keycode||i.activeImage!=i.imageArray.length-1&&(i.activeImage=i.activeImage+1,n(),o())}(e)})}),i.imageArray.length-1>i.activeImage&&(objNext=new Image,objNext.src=i.imageArray[i.activeImage+1][0]),i.activeImage>0&&(objPrev=new Image,objPrev.src=i.imageArray[i.activeImage-1][0])}),0==h&&0==s&&(e.browser.msie?l(250):l(100));e("#lightbox-container-image-data-box").css({width:t+2*i.containerBorderSize}),e("#lightbox-nav-btnPrev,#lightbox-nav-btnNext").css({height:a+2*i.containerBorderSize})}(s,b),t.onload=function(){}},t.src=i.imageArray[i.activeImage][0]}function o(){e(document).unbind()}function r(){e("#jquery-lightbox").remove(),e("#jquery-overlay").fadeOut(function(){e("#jquery-overlay").remove(),e("embed, object, select").css({visibility:"visible"})}),e(window).unbind("orientationchange",g)}function g(){setTimeout(function(){n()},250)}function c(){var e,i,t,a;return window.innerHeight&&window.scrollMaxY?(e=window.innerWidth+window.scrollMaxX,i=window.innerHeight+window.scrollMaxY):document.body.scrollHeight>document.body.offsetHeight?(e=document.body.scrollWidth,i=document.body.scrollHeight):(e=document.body.offsetWidth,i=document.body.offsetHeight),self.innerHeight?(t=document.documentElement.clientWidth?document.documentElement.clientWidth:self.innerWidth,a=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(t=document.documentElement.clientWidth,a=document.documentElement.clientHeight):document.body&&(t=document.body.clientWidth,a=document.body.clientHeight),pageHeight=i<a?a:i,pageWidth=e<t?e:t,arrayPageSize=new Array(pageWidth,pageHeight,t,a),arrayPageSize}function d(){var e,i;return self.pageYOffset?(i=self.pageYOffset,e=self.pageXOffset):document.documentElement&&document.documentElement.scrollTop?(i=document.documentElement.scrollTop,e=document.documentElement.scrollLeft):document.body&&(i=document.body.scrollTop,e=document.body.scrollLeft),arrayPageScroll=new Array(e,i),arrayPageScroll}function l(e){var i=new Date;t=null;do{var t=new Date}while(t-i<e)}return window._set_image_to_view=n,this.find("img").bind("touchend",function(i){i.preventDefault(),t||e(this).trigger("click"),!0,t=!1}),this.bind("touchmove",function(){t=!0}),this.click(function(o){t||e(this).attr("data-video")||(this.blur(),o.stopImmediatePropagation(),o.preventDefault(),function(t,a){if(e("embed, object, select").css({visibility:"hidden"}),function(){e("body").append('<div id="jquery-overlay"></div><div id="jquery-lightbox"><div id="lightbox-container-image-box"><div id="lightbox-container-image"><img id="lightbox-image"><div style="" id="lightbox-nav"><a href="#" id="lightbox-nav-btnPrev"></a><a href="#" id="lightbox-nav-btnNext"></a></div><div id="lightbox-loading"><a href="#" id="lightbox-loading-link"><img src="'+i.imageLoading+'"></a></div><div id="lightbox-video-link"></div></div></div><div id="lightbox-container-image-data-box"><div id="lightbox-container-image-data"><div id="lightbox-image-details"><span id="lightbox-image-details-caption"></span><span id="lightbox-image-details-currentNumber"></span></div><div id="lightbox-secNav"><a href="#" id="lightbox-secNav-btnClose"><img src="'+i.imageBtnClose+'"></a></div></div></div></div>');var t=c();e("#jquery-overlay").css({backgroundColor:i.overlayBgColor,opacity:i.overlayOpacity,width:t[0],height:t[1]}).fadeIn();var a=d();e("#jquery-lightbox").css({top:a[1]+(i.top||t[3]/10),left:a[0]}).show(),e("#jquery-overlay,#jquery-lightbox").click(function(){r()}),e("#lightbox-loading-link,#lightbox-secNav-btnClose").click(function(){return r(),!1}),e("#lightbox-video-link").click(function(){r();var e=JSON.parse(i.imageArray[i.activeImage][2]);e&&window.ekmPlayProductVideo&&ekmPlayProductVideo(e)}).hide(),setTimeout(function(){e(window).bind("orientationchange",g)},40),e(window).resize(function(){var t=c();e("#jquery-overlay").css({width:t[0],height:t[1]});var a=d();e("#jquery-lightbox").css({top:a[1]+(i.top||t[3]/10),left:a[0]})})}(),i.imageArray.length=0,i.activeImage=0,1==a.length)i.imageArray.push(new Array(t.getAttribute("href"),t.getAttribute("title"),t.getAttribute("data-video")));else for(var o=0;o<a.length;o++)i.imageArray.push(new Array(a[o].getAttribute("href"),a[o].getAttribute("title"),a[o].getAttribute("data-video")));for(i.imageArray=e.grep(i.imageArray,function(e,i){return"#"!=e[0]&&e[0]!=window.location.href+"#"});i.imageArray[i.activeImage][0]!=t.getAttribute("href");)i.activeImage++;n()}(this,a))})}}(ekm.$);