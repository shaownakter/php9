!function(){function t(t){var n=t.getAttribute("data-endless-scroll-id");return null!==n?c[n]:(n=e(),t.setAttribute("data-endless-scroll-id",n),c[n]={distanceFromBottomToTrigger:0,showDataElementDistanceFromTop:0,showDataElementDistanceFromBottom:0})}function e(){var t=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(t+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:3&n|8).toString(16)})}function n(e){if(e&&b(document,e)){for(var n=e.parentNode;!r(n,"ekm-output-start");)n=n.parentNode;var o=document.body,a=document.documentElement,i=Math.max(o.scrollHeight,o.offsetHeight,a.clientHeight,a.scrollHeight,a.offsetHeight),s=t(e);s.showDataElementDistanceFromTop=-n.getBoundingClientRect().top,s.showDataElementDistanceFromBottom=-(n.getBoundingClientRect().bottom-i),s.distanceFromBottomToTrigger=(n.offsetHeight||n.clientHeight)/2;var l=function(t){window.addEventListener("scroll",t,!1)},d=function(t){window.removeEventListener("scroll",t,!1)},u=function(){var t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,o=(document.body.scrollTop||document.documentElement.scrollTop)+t,r=o+s.showDataElementDistanceFromTop,a=n.offsetHeight-s.distanceFromBottomToTrigger+s.showDataElementDistanceFromBottom;if(r>a){if(d(u),e=document.querySelector("[data-endless-scroll]"),!e)return;if(e.click)e.click();else if(document.createEvent){var i=document.createEvent("MouseEvents");i.initEvent("click",!0,!0),e.dispatchEvent(i)}}};l(u)}}window.loadMoreResults=function(t,e,n){var r=new o(t,n);r.replaceButtonWithSpinner(),r.loadMoreResults(e)};var o=function(t,e){this.tagId=e,this.filterByForm=document.querySelector("form.ekm-filterby-form[data-showdata-id='"+this.tagId+"']"),this.sortByForm=document.querySelector("form.ekm-sortby-form[data-showdata-id='"+this.tagId+"']"),this.button=t,this.showDataElement=document.getElementById(e),this.spinner=i("ekm-load-more-spinner","ekm-load-more-button",t.parentNode),this.loadMoreInfo=JSON.parse(t.getAttribute("data-loadmore-info")),this.loadMoreFinished=!1};o.prototype={replaceButtonWithSpinner:function(){var t=this.filterByForm,e=this.sortByForm;t&&t.getAttribute("data-callback-requeststart")?s(t.getAttribute("data-callback-requeststart"),t):e&&e.getAttribute("data-callback-requeststart")&&s(e.getAttribute("data-callback-requeststart"),e),u(this.spinner),this.button.parentNode.removeChild(this.button)},makeParam:function(t,e){return encodeURIComponent(t)+"="+encodeURIComponent(e)},getFilterFormData:function(t){var e=[];if(e[e.length]=this.makeParam("_",""),e[e.length]=this.makeParam("function","PRODUCT-FILTER"),e[e.length]=this.makeParam("element-id",this.tagId),e[e.length]=this.makeParam("pageNumber",t),e[e.length]=this.makeParam("loadmore",!0),this.button.getAttribute("data-endless-scroll")){var n=this.button.getAttribute("data-endless-scroll");e[e.length]=this.makeParam("loadmoreendless",n)}if(this.sortByForm){var o=this.sortByForm.querySelector("#ekm-sortby-option");e[e.length]=this.makeParam(o.name,o.options[o.selectedIndex].value)}if(!this.filterByForm)return e.join("&");for(var r=this.filterByForm,a=0;a<r.elements.length;a++){var i=r.elements[a];"checkbox"===i.getAttribute("type")?i.checked&&(e[e.length]=this.makeParam(i.name,i.value)):e[e.length]=this.makeParam(i.name,i.value)}return e.join("&")},loadMoreResults:function(t){var e=new XMLHttpRequest,n=this;e.onreadystatechange=function(){4===e.readyState&&200===e.status&&n.onComplete(e.responseText)};var o=this.loadMoreInfo.nextPageUrl;0!==this.loadMoreInfo.location&&(o=o+"?"+this.getFilterFormData(t)),e.open("GET",o),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.send()},onComplete:function(t){var e=document.createElement("div");e.innerHTML=t;var n=e.querySelector("[data-loadmore-info]"),o=e.querySelector("#"+E(this.tagId))||e,a=i("ekm-output-start","ekm-output-end",o),s=r(this.showDataElement,"ekm-output-end"),u=this.loadMoreInfo.animation;if(u?this.insertRowsAnimate(a,s,u):this.insertRowsNoAnimation(a,s),n&&0!==n.length){this.button=n,this.loadMoreInfo=JSON.parse(n.getAttribute("data-loadmore-info"));var c=r(this.spinner[0].parentNode,"ekm-load-more-button");c||(c=r(this.showDataElement.parentNode,"ekm-load-more-button")),l(n,c)}else this.removeButtonContainer(),this.loadMoreFinished=!0;d(this.spinner),this.updateResultEnd(),u||this.callRequestEndCallback()},updateResultEnd:function(){var t=this.loadMoreInfo,e=t.resultEnd>t.totalResults?t.totalResults:t.resultEnd;this.loadMoreFinished&&(e=t.totalResults);for(var n=this.showDataElement.querySelectorAll("span.ekm-result-end, span.ekm-showing-results-count"),o=0;o<n.length;o++){for(var r=n[o];r.firstChild;)r.removeChild(r.firstChild);r.appendChild(document.createTextNode(e))}},insertRowsAnimate:function(t,e,n){var o=document.createElement("div");y(t,o),o=t[0].parentNode,e.parentNode.insertBefore(o,e);var r=this,a=function(){w(t),r.callRequestEndCallback()};if("slide"===n){var i;try{i=parseInt(o.clientHeight())/10}catch(s){}i||(i=400),v(o,i,a)}else g(o,400,a)},insertRowsNoAnimation:function(t,e){for(var n=0;n<t.length;n++){var o=t[n];e.parentNode.insertBefore(o,e)}},callRequestEndCallback:function(){var t=this.filterByForm,e=this.sortByForm;if(t&&t.getAttribute("data-callback-requestend")?s(t.getAttribute("data-callback-requestend"),t):e&&e.getAttribute("data-callback-requestend")&&s(e.getAttribute("data-callback-requestend"),e),this.loadMoreInfo.callback){var o=JSON.parse(this.button.getAttribute("data-loadmore-info"));o.loadMoreButton=this.button,o.showDataElement=this.showDataElement,s(this.loadMoreInfo.callback,o)}try{window.top.redrawShowHideButton&&(window.top.redrawShowHideButton(),ekm.singleEditButtons.init(this._element))}catch(r){}n(this.button)},removeButtonContainer:function(){var t=this.spinner[0].parentNode;if(!t||!t.id||t.id!==this.tagId){for(;t.parentNode.id!==this.tagId;)t=t.parentNode;t.parentNode.removeChild(t)}}};var r=function(t,e){if(!t||3===t.nodeType)return null;var n=t.childNodes;if(!n){if(t=t[0],!t)return null;if(n=t.childNodes,!n)return null}for(var o=8,i=n.length-1;i>=0;i--){var s=n[i];if(s.nodeType===o){var l=s.textContent||s.innerHTML;if(l=l.replace("<!--",""),l=l.replace("-->",""),l=a(l),l===e)return s}else{var d=r(s,e);if(d)return d}}return null},a=function(t){var e=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;return t.replace(e,"")},i=function(t,e,n){var o=r(n,t),a=r(n,e);if(o.parentNode!==a.parentNode)return null;for(var i=o.parentNode,s=0,l=0,d=i.childNodes.length-1;d>=0;d--){var u=i.childNodes[d];u===o?s=d:u===a&&(l=d)}return Array.prototype.slice.call(i.childNodes,s+1,l)},s=function(t){if(null!==t){var e=window[t];if("function"==typeof e){var n=Array.prototype.slice.call(arguments,1);e.apply(e,n)}}},l=function(t,e){return e.parentNode.insertBefore(t,e.nextSibling)},d=function(t){for(var e=t.length-1;e>=0;e--){var n=t[e];n.style&&(n.style.display="none")}},u=function(t){for(var e=t.length-1;e>=0;e--){var n=t[e];n.style&&(n.style.display="")}},c={},m=function(t,e){return t.currentStyle?t.currentStyle[e]:window&&window.getComputedStyle?window.getComputedStyle(t,null)[e]:t.style[e]},h=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return setTimeout(t,40)},f=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelRequestAnimationFrame||function(t){clearTimeout(t)},p=function(t,e,n){this._element=t,this._duration=e,this._properties=n,this._stopped=!1,this._requestId=null};p.prototype={_tick:function(){if(!this._stopped){var t=this._duration,e=this._startTime,n=this._properties,o=+new Date,r=(o-e)/t;r=Math.min(1,r);for(var a in n)n.hasOwnProperty(a)&&this._update(a,n[a],r);if(1===r&&(this._stopped=!0),this._stopped)this._requestId=null,this.onStop(),this.onComplete();else{var i=this;this._requestId=h(function(){i._tick()})}}},_update:function(t,e,n){var o=this._element,r=e[0],a=e[1],i=e.length>2?e[1]:"px",s=(a-r)*n+r;o.style[t]=s.toFixed(4)+i},start:function(){this._startTime=+new Date,this._stopped=!1;var t=this;this._requestId=h(function(){t._tick()})},stop:function(){this._stopped=!0,null!==this._requestId&&(f(this._requestId),this._requestId=null,this.onStop())},onComplete:function(){},onStop:function(){}};var v=function(t,e,n){n||"function"!=typeof e||(n=e,e=400),e=e||400;var o=parseFloat(m(t,"marginTop"))||0,r=parseFloat(m(t,"paddingTop"))||0,a=parseFloat(m(t,"height"))||0,i=parseFloat(m(t,"paddingBottom"))||0,s=parseFloat(m(t,"marginBottom"))||0,l=new p(t,e,{marginTop:[0,o],paddingTop:[0,r],height:[0,a],paddingBottom:[0,i],marginBottom:[0,s]});return l.onStop=function(){t.style.overflow=""},l.onComplete=function(){t.style.marginTop="",t.style.paddingTop="",t.style.height="",t.style.paddingBottom="",t.style.marginBottom="","function"==typeof n&&n()},t.style.overflow="hidden",l.start(),l},g=function(t,e,n){n||"function"!=typeof e||(n=e,e=400),e=e||400;var o=new p(t,e,{opacity:[0,1,""]});return o.onComplete=function(){t.style.opacity="","function"==typeof n&&n()},t.style.overflow=0,o.start(),o},y=function(t,e){t[0].parentNode.insertBefore(e,t[0]);for(var n=0,o=t.length;o>n;n++)e.appendChild(t[n])},w=function(t){for(var e=t[0].parentNode,n=e.parentNode,o=0,r=t.length;r>o;o++)n.insertBefore(t[o],e);n.removeChild(e)},b=function(t,e){for(;e;){if(e==t)return!0;e=e.parentNode}return!1},k=function(t,e){for(var n=0,o=t.length;o>n;n++)e(t[n],n,t)},E=function(t){if(0==arguments.length)throw new TypeError("`CSS.escape` requires an argument.");for(var e,n=String(t),o=n.length,r=-1,a="",i=n.charCodeAt(0);++r<o;)e=n.charCodeAt(r),a+=0!=e?e>=1&&31>=e||127==e||0==r&&e>=48&&57>=e||1==r&&e>=48&&57>=e&&45==i?"\\"+e.toString(16)+" ":(0!=r||1!=o||45!=e)&&(e>=128||45==e||95==e||e>=48&&57>=e||e>=65&&90>=e||e>=97&&122>=e)?n.charAt(r):"\\"+n.charAt(r):"�";return a},F=function(t,e){var n=!1,o=!0,r=t.document,a=r.documentElement,i=r.addEventListener?"addEventListener":"attachEvent",s=r.addEventListener?"removeEventListener":"detachEvent",l=r.addEventListener?"":"on",d=function(o){("readystatechange"!=o.type||"complete"==r.readyState)&&(("load"==o.type?t:r)[s](l+o.type,d,!1),!n&&(n=!0)&&e.call(t,o.type||o))},u=function(){try{a.doScroll("left")}catch(t){return void setTimeout(u,50)}d("poll")};if("complete"==r.readyState)e.call(t,"lazy");else{if(r.createEventObject&&a.doScroll){try{o=!t.frameElement}catch(c){}o&&u()}r[i](l+"DOMContentLoaded",d,!1),r[i](l+"readystatechange",d,!1),t[i](l+"load",d,!1)}},x=function(t,e){for(var n=1,o=8,r=9,i=null;t.nodeType!==r;){for(var s=0,l=t.childNodes.length;l>s;s++){var d=t.childNodes[s];if(d.nodeType===o){var u=d.textContent||child.innerHTML;if(u=u.replace("<!--",""),u=u.replace("-->",""),u=a(u),u===e)return t}else if(d.nodeType===n&&d!==i&&T(d,e))return t}i=t,t=t.parentNode}return null},T=function(t,e){for(var n=8,o=[t];o.length>0;){var r=o.pop();if(r.nodeType===n){var i=r.textContent||child.innerHTML;if(i=i.replace("<!--",""),i=i.replace("-->",""),i=a(i),i===e)return!0}o=o.concat([].slice.call(r.childNodes,0).reverse())}return!1},A=function(t){if(window.MutationObserver){var e=x(t,"ekm-output-start");if(null!==e){var n=new MutationObserver(function(t){k(t,function(t){if(t.addedNodes.length>0){clearTimeout(n);var n=setTimeout(function(){d(i("ekm-load-more-spinner","ekm-load-more-button",e))},40)}})}),o={childList:!0,subtree:!1};n.observe(e,o)}}},N=function(){var t=document.querySelectorAll("[data-loadmore-info]");k(t,function(t){t.hasAttribute("data-endless-scroll")&&n(t),d(i("ekm-load-more-spinner","ekm-load-more-button",t.parentNode)),A(t)})};F(window,N)}();